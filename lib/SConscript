# -*- python -*-
from lsst.sconsUtils import scripts, targets, env
import os

# suiteparse = "/sps/lsst/Library/SuiteSparse"
suiteparse = "SuiteSparse"

for flag in ("-fexceptions", "-DNSUPERNODAL", "-DNPARTITION"):
    env["CFLAGS"].append(flag)
    env["CXXFLAGS"].append(flag)

includes = ("SuiteSparse_config", 
"templates", 
"Include",
"AMD/Include",
"CHOLMOD/Include",
"COLAMD/Include")

for include in includes:
    env["CFLAGS"].append("-I./%s" % include)

objs = env.SourcesForSharedLibrary(Glob("#src/*.c"))

libs = env.getLibs("self")
# librt does not seem to be useful (neither on linux nor mac)
if 'Linux' in os.environ['OS']:
    libs.append("rt")
targets["lib"].extend(env.SharedLibrary(env["packageName"], objs, LIBS=libs))


